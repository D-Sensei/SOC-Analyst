-----

## üõ°Ô∏è The Security Operations Center (SOC) Workflow


### Behind-the-Scenes Threat Detection and Response Workflow
- Data Collection
- Data Normalisation and correlation
- Alert Triage
- Incident Investigation
- Incident Response
- Recovery, Documentation

## 1\. Data Collection üì•

This foundational phase involves continuously gathering raw event data (telemetry) from every corner of the IT infrastructure.

| Source Type | Examples | Data Collected |
| :--- | :--- | :--- |
| **Network Devices** | Firewalls, Routers, IDS/IPS | Traffic flows, blocked ports, connection attempts, scanning logs |
| **Endpoint Devices** | EDR, Antivirus, OS Logs | File access, process creation, command-line execution, registry changes |
| **Servers & Applications** | Web servers, Database servers, Email systems | Authentication logs, SQL queries, web requests, application access logs |
| **Identity & Access Mgmt (IAM)** | Active Directory, Okta, LDAP | Logins (successful/failed), login duration, user provisioning/de-provisioning |
| **Cloud Infrastructure** | AWS CloudTrail, Azure Logs, GCP Stackdriver | API calls, account setting changes, cloud resource modifications |
| **Security Tools** | SIEM, SOAR, DLP, UEBA | Generated alerts, correlation output, calculated risk scores |
| **Threat Intelligence (TI) Feeds** | STIX/TAXII, OSINT, Commercial Feeds | Known malicious IPs/domains, TTPs (Tactics, Techniques, and Procedures), IOCs (Indicators of Compromise) |

-----

**Event $\rightarrow$ Log $\rightarrow$ Alert**
  * **Event:** A singular, discrete occurrence, e.g., "User X initiated a login attempt to server Y at 3:45 AM."
  * **Log:** The recorded, structured version of the event (e.g., in key-value or JSON format), collected by the system.
    > ```json
    > {
    >   "timestamp": "2025-06-23T03:45:01Z",
    >   "event_type": "user_login",
    >   "user": "userX",
    >   "source_ip": "10.1.2.3",
    >   "device": "serverY"
    > }
    > ```
  * **Alert:** A notification generated when a log, or sequence of logs, matches a predefined rule or pattern that suggests **suspicious or malicious behavior**.
    > **Example Alert:** "Multiple failed logins followed by a successful login outside business hours from an unusual IP."

-----

## 2\. Data Normalization and Correlation üîó

This phase transforms raw data into actionable intelligence.

### Normalization: Standardizing the Noise

It's the process of converting various log formats from disparate sources into a **common, standard structure (schema)**.

  * **Goal:** To ensure consistent field names for efficient searching and correlation.
  * **Example:** A Firewall log calls the source IP "**src\_ip**," <br>
  while a Linux syslog uses "**sources-addr**," and <br>
  a Cloud log uses "**ip.src**." <br>
  Normalization maps all these to a single standard field, like `source_ip`.

### Correlation: Connecting the Dots

It's the process of linking multiple normalized events across different systems to detect complex patterns that a single event would miss.

  * **Example of a Malicious Sequence:**
    1.  Successful **login from a new device** (Individual log: low-risk).
    2.  Followed by **privilege escalation** (Linking log: medium-risk).
    3.  Followed by a **large data download** (Final sequence: **High-Risk Incident** - Potential Insider Threat or Malware).

-----

## 3\. Alert Triage (Tier 1 Focus) üö®

Alert Triage is the rapid evaluation, categorization, and prioritisation of incoming security alerts, typically handled by **Tier 1 SOC Analysts**.

  * **Analogy:** The Tier 1 Analyst acts as the **Nurse** in a cybersecurity. If, as a nurse, you have 2 patients(events/alerts), one with sharp pain in the chest and the other with a small wound. As a nurse, you must attend to the critical patient first, irrespective of its complexity. If it's not solvable at your end, pass the case to a Doctor (Tier 2 Analyst or Incident Responder). If the doctor can't solve it, he consults or escalates the case to a surgeon/specialist (Tier 3 Analyst/threat hunter)
  * **Purpose of Triage/Tier 1 Analyst:**
      * Filter out **False Positives** (benign activities).
      * Identify true security incidents swiftly.
      * Determine priority based on severity and asset value (e.g., malware on a critical database server is high priority).
      * Escalate to higher tiers when necessary.

### Step-by-Step Triage Process

1.  **Receive Alert** from SIEM/EDR.
2.  **Enrich Alert:** Add context using Threat Intelligence (IP reputation, file hash check), User Behavior Analysis, and Asset Value.
3.  **Evaluate Credibility:** Determine if the alert is real or a benign false positive.
4.  **Assess Severity & Categorize:**
      * **Low:** (Monitor)
      * **Medium:** (Investigate further)
      * **High:** (Immediate escalation or containment)
5.  **Action/Escalate:**
      * Close the alert if confirmed benign.
      * Escalate to Tier 2 for deeper analysis.
      * Trigger immediate containment actions (e.g., system isolation) if confirmed malicious.

### Scenario Example

  * **Alert:** Potential Malware Download
  * **Host:** Laptop \#9 (HR Dept, User: S. Conway)
  * **Target File:** `Cat2025.mp4.exe` (User downloaded an executable disguised as a video)
  * **Action:** Contact the user, enforce deletion, and investigate the source/vector.

-----

## 4\. Incident Investigation (Tier 2/3 Focus) üîé

This phase is a deep dive into escalated alerts to confirm and understand the scope of a true security incident.

### Step 1: Initial Triage (Tier 1)

  * Out of 100 raw alerts, Tier 1 filters out 85-90 as false positives or minor issues.
  * **10-15 suspicious alerts are escalated** to Tier 2 (e.g., unusual login followed by PowerShell activity).

### Step 2: Deep Investigation (Tier 2)

  * The escalated alerts are thoroughly **correlated with logs from multiple sources**.
  * **Cross-referenced with Threat Intelligence** and mapped to adversary behavior (e.g., **MITRE ATT\&CK mapping**).
  * **Outcome:** Most are confirmed safe or containable, but perhaps **1 complex case** requires specialized attention.

### Step 3: Specialized Analysis (Tier 3)

  * This is reserved for serious, complex cases like an **Advanced Persistent Threat (APT)**, sophisticated insider activity, or bypassed malware.
  * **Activities:** Memory analysis, Packet Capture (PCAP) review, Reverse Engineering of malware, and comprehensive Root Cause Analysis.
  * **Result:** Confirming the extent of the compromise and determining the necessary **Incident Response** plan.

-----

## 5\. Incident Response (IR) üõë

The active phase of managing and mitigating the confirmed threat. A typical mnemonic for the steps is **2CETISRPMU** (Confirmation, Containment, Eradication, etc.).

| Step | Action and Goal |
| :--- | :--- |
| **Confirmation & Classification** | Formally confirm the incident (e.g., Data Breach, Ransomware) and assign the response team. |
| **Containment (Short-Term)** | **Isolate** the affected systems (e.g., disable network port, disable compromised user account) to stop the spread. |
| **Evidence Preservation** | Forensic capture of volatile data (memory dumps, disk images) and logs. **Maintain Chain of Custody.** |
| **Threat Eradication** | Remove the root cause: delete malware, kill malicious processes, patch the exploited vulnerability, and reset compromised credentials. |
| **Internal Communication** | Notify relevant teams (Legal, Compliance, IT, Management) with factual updates. |
| **System Restoration** | **Restore systems** from clean backups or re-image affected machines to a known good state. |
| **Reconnection & Testing** | Gradually reconnect the cleaned systems to the production network after validation checks. |

-----

## 6\. Recovery & Documentation ‚úçÔ∏è

The final phase focuses on improving security posture and ensuring a complete recovery.

  * **Patching & Hardening:** Apply missing security patches, disable unused services, tighten access controls, and enforce **Multi-Factor Authentication (MFA)**.
  * **Monitoring for Recurrence:** Implement intensified monitoring or use **deception tools (honeypots)** on affected systems to detect residual attacker presence.
  * **Documentation & Reporting:**
      * File a comprehensive final report detailing: **Who, What, When, Where, and Why** (the Root Cause/Reasoning).
      * Conduct a **Lessons Learned** review to update security policies, rules, and procedures, effectively completing the feedback loop.
      * Handle legal/compliance notifications (e.g., reporting PII breaches).

-----

Would you like me to elaborate on a specific phase of the SOC workflow, such as the MITRE ATT\&CK framework used in Incident Investigation?
